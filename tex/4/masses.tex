%!TEX root = ../thesis.tex
%Adding the above line, with the name of your base .tex file (in this case "thesis.tex") will allow you to compile the whole thesis even when working inside one of the chapter tex files

\singlespacing
\chapter{Coronal Mass Ejection Masses, Energetics, and Forces} 
\label{chap:4}
\vspace{-6mm}
\doublespacing
In the past, measurement of CME dynamics have been hindered by highly uncertain estimates of the total mass of the ejection. The primary source of uncertainty is the unknown position and geometry of the CME, leading to an erroneous treatment of the Thomson scattering equations which are used to estimate the mass. Geometrical uncertainty on the CMEs position and size has primarily been due to observations of the eruption from a single vantage point. However, with the launch of the {\it Solar Terrestrial Relations Observatory (STEREO)} mission, the two viewpoints can be exploited to derive the CMEs position and size, ultimately resulting in mass uncertainty that is both reliably quantified and much reduced. This then leads to better estimates of the energies and forces. This chapter will first outline the Thomson scattering theory used to compute CME mass, followed by a discussion of the mass uncertainties. This work includes the smallest uncertainties in the literature on CME mass, and the first estimate CME force magnitude from observations. This chapter is based on work published in Carley, McAteer, \& Gallagher, {\it The Astrophysical Journal}, 2012.

\section{Introduction}\label{sec:1}

Despite many years of study, the origin of the forces that drive coronal mass ejections (CMEs) in the solar corona and interplanetary space are not well understood. From an observational viewpoint a complete understanding of CME kinematics, dynamics and forces requires not only a study of CME speed, acceleration and expansion but also an accurate knowledge of CME mass.  The measurements of CME mass combined with acceleration measurements can be used to quantify the magnitude of the force that drives a CME. Knowledge of this force magnitude can lead to an identification of the possible origin of the CME driver. 

There are numerous theoretical models that attempt to explain the triggering of CME eruption and its consequent propagation. Each describe the destabilization and propagation of a complex magnetic structure, such as a flux rope, via mechanisms that include the catastrophe model \citep{forbes1991,forbes1995,lin2000}, magnetic breakout model \citep{antio99,lynch2008}, or a toroidal instability model \citep{chen1996,kleim2006}, each described in Chapter 2. The loss of equilibrium induced by such mechanisms results in CME propagation into interplanetary space. The predictions of these models have been investigated in observational studies whereby the CME kinematics are used to constrain what forces might be at play and hence which model best describes CME propagation. Such studies show that early phase propagation can be reasonably described by the existing models (or a combination of them) involving some form of magnetic CME driver \citep{manoh2003, chen2006, schrijver2008c, lin2010}, and that aerodynamic drag of the solar wind may have a significant role at later stages of CME propagation \citep{howard2007, malo10, byrne2010}. Comparisons between modeling and observational estimates of the forces that drive CMEs requires an accurate determination of CME kinematics properties as well as CME mass.

To date, the most prevalent method of determining CME mass has been through the use of white light coronagraph imagers, such as the Large Angle Spectroscopic Coronagraph  \citep[LASCO;][]{bru95} on board the \emph{Solar and Heliospheric Observatory} \citep[\emph{SOHO};][]{dom95}  and the twin Sun Earth Connection Coronal and Heliospheric Investigation (SECCHI) COR1 and COR2 coronagraphs \citep{how08} on board the \emph{Solar Terrestrial Relations Observatory}  \citep[\emph{STEREO};][]{kai08}. The white-light emission imaged by such coronagraphs occurs via Thomson scattering of photospheric light by coronal electrons \citep{min30, vdeh50, bil66}, the so called K-corona.  From classical Thomson scattering theory, the intensity of the light detected by an observer depends on the particle density of the scattering plasma. Hence, any density enhancement, such as a CME, over the background coronal density appears as enhanced emission in white light. The enhanced emission allows for a calculation of the total electron content and hence mass. 

Some of the first measurements of CME mass using scattering theory were carried out by \citet{munro1979} and \citet{poland1981} using space-based white light coronagraphs on board \emph{SkyLab} and U.S. military satellite\,\emph{P78-1}.  Both the early studies  and later statistical investigations determined that the majority of CMEs have masses in the range of 10$^{13}$--10$^{16}$\,g, \citep{vourlidas02, vour2010}. However, due to only a single viewpoint of observation, the longitudinal angle at which the CME propagates outwards was largely unknown in these studies 
and it is generally assumed that the CME propagates perpendicular to the observers line-of-sight (LOS). There is also the added assumption that all CME mass lies in the two-dimensional plane-of-sky (POS). Such assumptions can lead to a mass underestimation of up to 50\% or more \citep{vou00}. More recent studies have employed the two viewpoint capabilities of the \emph{STEREO} mission to determine the mass of numerous 
CMEs with much less uncertainty \citep{cola09}. 
	
This Chapter presents an analysis of mass development of the 2008 December 12 CME using the \emph{STEREO} COR1 and COR2 coronagraphs. We use a well constrained angle of propagation to determine the mass and position of the CME. Combining the mass measurements with values for CME velocity and acceleration, the kinetic energy and the magnitude of the force influencing propagation is determined for each point in time. The first section described the observations of the event from first appearance of the front in COR1 A and B to the time when the front exits the COR2 A and B fields of view. 
The data analysis section describes the methods by which the masses are calculated with \emph{a priori} knowledge of the propagation angle, as well as a discussion of the primary sources of uncertainty. Followed by this are the results, including masses, energies and forces on the CME. Finally, a discussion is given of the possible forces attributable to the observed accelerations and whether they are magnetic or aerodynamic in origin. 

\section{Observations}

The COR1 images used in this analysis span from 2008 December 12 04:05\,UT to 15:45\,UT, with a cadence of 10\,minutes. The three polarization states of COR1 were combined to make total brightness images in units of mean solar brightness (MSB). Base difference images were produced using the 04:05\,UT image (in both COR1\,A\,and\,B) as a background to be subtracted from all subsequent images. A sample of such images for both COR1\,A and B can be found in Figure~\ref{fig:STEREO_COR1A&B}. The COR2 images analyzed range from from 07:22\,UT to 17:52\,UT, with a cadence of 30\,minutes. As with the COR1 images, total brightness images were created for COR2, and a set of base difference images were then produced using the 07:22\,UT image as a suitable background. A selected set of images from COR2 can be found in Figure~\ref{fig:STEREO_COR2A&B}. Note that the pixel values in Figures~\ref{fig:STEREO_COR1A&B} and~\ref{fig:STEREO_COR2A&B}  have been converted to grams; the method by which this is done is described in the next section.
	
At 04:35\,UT the leading edge of a CME appeared in COR1\,A and B coronagraphs at a height of $\sim$1.4\,$R_{\odot}$, off the east and west limb respectively. In COR1\,B the CME first appears as a set of rising loop-like structures followed by a prominence, part of which appears to fall back to the surface at 08:00\,UT while the remainder was ejected and follows the rising loop-like structures which eventually become the CME front. The rising prominence was not apparent at any stage of the propagation in COR1\,A and the advancing front remains the only distinguishable facet 
of the CME from this line-of-sight (LOS).
\begin{sidewaysfigure}
    \centering
	\includegraphics[scale=0.6]{cor1ab_color.pdf}
	\caption [2008-December-12 CME observed by COR1] {Selection of base difference images of the CME in COR1\,A  
	(top row) and COR1\,B (bottom row). The CME is quite faint in the A images and appears not to have as much structure
	as in B. As indicated by the color bar on the right, this image has units of grams. The method by which pixel units of 		grams are derived is described below.}
\label{fig:STEREO_COR1A&B}
\end{sidewaysfigure}

\begin{sidewaysfigure}
    \centering
    \includegraphics[scale=0.6]{cor2ab_color.pdf}
	\caption [2008-December-12 CMe observed by COR2]{Selection of base difference images of the CME in COR2\,A (top 	row) and COR2\,B (bottom row), with pixel values of grams. The CME is 
	clearly distinguishable in both fields of view. Only the B field view shows clearly the three part structure of core, cavity 	and front. As with the COR1 images these images also have units of grams; the method by which grams are calculated 	is described below.}
\label{fig:STEREO_COR2A&B}
\end{sidewaysfigure}    

A noteworthy caveat of using base difference imaging is the assumption that the background corona in the pre-event image has the same brightness in all subsequent images. This may not always be true and any excess brightness in the pre-event image will produce negative pixel values in the base difference. This is apparent in the COR1 images as the CME interacts with a streamer, displacing it as the leading CME front expands laterally as well as moves outward. The streamer is visible as a dark feature that grows with time at the southward flank of the CME in the COR1\,B images, Figure~\ref{fig:STEREO_COR1A&B}. The black areas are indicative of negative pixel values. The COR1\,A images also suffer from negative pixels, especially at later times, see Figure~\ref{fig:STEREO_COR1A&B} top row, 09:15\,UT image. 
The front of the CME starts to exit both the A and B field of view at $\sim$08:35\,UT.

The CME first appears in the COR2 field of view at $\sim$07:52\,UT with the CME apex at a height of $\sim$3\,$R_{\odot}$ in both A and B images. In the B coronagraph, by 10:52\,UT the three part structure of core, cavity, and bright front is clearly visible and the overall structure grows in size as the CME propagates to larger heights. The core becomes more tenuous and the mass distribution becomes homogenous after 15:52\,UT when the front starts to exit the field of view. The distinction between core and front is not as clear in COR2\,A and the mass distribution appears more homogenous throughout the propagation. As with the COR1 images, COR2\,A is also affected by excess brightness in the pre-event image, as is apparent by a growing dark feature in its southern half. As the pre-event image for COR2\,B is the cleanest of the pre-event images (it contains the least contamination by streamers), the COR2\,B data are considered the best candidate for accurate CME mass measurements. 



\section{Data Analysis}\label{sec:10}

A conversion from pixel units of mean solar brightness to grams requires a knowledge of how electrons scatter photospheric light in the corona. A brief overview of the theory is given here, along with a discussion of the uncertainties due to some unknowns about the CME position and shape.

\subsection{Thomson Scattering in the Corona}\label{sec:10}
\doublespacing
Thomson scattering involves an incident electromagnetic wave exciting an oscillation of an electron such that the electron radiates like a small dipole. In this way some of the incident electromagnetic energy is `scattered' in a variety of directions, given by the radiation pattern of the oscillating electron. Any incident radiation falling on the area
\begin{equation}
\sigma_T = \frac{8\pi}{3}\bigg(  \frac{e^2}{4\pi\epsilon_0 m_e c^2}   \bigg)^2 = \frac{8\pi}{3}r_e^2 = 6.65\times10^{-29}\,\mathrm{m}^2
\end{equation}
will be scattered by the electron into a dipole radiation pattern. $r_e$ is the classical electron radius and the cross section used in the following analysis will be $\sigma_e = r_e^2$. The area is the Thomson scattering cross-section and is independent of wavelength of the incident wave; all wavelengths are scattered equally. 

\begin{figure}[!t]
\begin{center}
\includegraphics[scale=0.35, trim=1cm 0cm 0cm 0cm]{t_scatter}
\caption[Thomson scattering schematic.]{Thomson scattering schematic \citep{howtap2009}.}
\label{fig:tscatter}
\end{center}
\end{figure}
Solar photospheric radiation is completely unpolarized, hence the radiation incident on a coronal electron with set it into an oscillation with an amplitude that is equal in all directions. In Figure ~\ref{fig:tscatter}, their are two components to the incoming light, setting the electron into oscillation parallel to the page and perpendicular to it. No matter what the viewing angle, $\chi$, the perpendicular oscillation will always be observed to have the same amplitude. However, the parallel component will be fore-shortened, depending on $\chi$. In this way, the radiation may appear unpolarized, partially polarized, or completely linearly polarized.

\citet{schuster1879} and \citet{minnaert1930} were the first to formalise the Thomson scattering theory for an electron in the solar atmosphere. The electron is set into oscillation by an unpolarized  incident intensity $I_0$.
The two components of radiation observed are the tangential component, $I_T$ in the plane perpendicular to the page, and radial component, $I_R$ in the plane of the page Figure~\ref{fig:omega}. 
These two components are given by the expressions \citep{howtap2009}
\begin{eqnarray}
I_T &=& I_0\frac{\pi \sigma_e}{2z^2}[(1-u)C +uD] \\
I_P &=& I_0\frac{\pi \sigma_e}{2z^2}\mathrm{sin}^2\chi[(1-u)A +uB] \\
I_R &=& I_T-I_P
\end{eqnarray}
where $I_0$ is incident intensity, $\sigma_e$ is the electron scattering cross section, $z$ is the distance from scatterer to observer, $u$ is a limb darkening coefficient. $I_R$ is given via a polarization intensity $I_P$ for ease of derivation. These equations describe theoretically the concepts outlined in Figure~\ref{fig:tscatter} e.g, both $I_T$ and $I_R$ are fully observed at $\chi=0^{\circ}$ and $\chi=180^{\circ}$, while only $I_T$ is observed at $\chi=90^{\circ}$. 
\begin{figure}[!t]
\begin{center}
\includegraphics[scale=0.5, trim=0cm 2cm 0cm 0cm]{omega_new.pdf}
\caption[Thomson scattering geometry in the solar corona]{Thomson scattering geometry in the solar corona. The orientation of $I_R$ and $I_T$ is shown in the inset. $I_R$ is the projection of electron oscillation in the x direction onto a plane perpendicular to the line from Q to observer. $I_R$ is zero when $\chi=90$. $I_T$ is due to electron oscillation out of the plane of the page (z-direction), and is completely unaffected by viewing angle. Figure adapted from Figure 3 of \citep{howtap2009}.}
\label{fig:omega}
\end{center}
\end{figure}
The main complication for Thomson scattering by a coronal electron is that the Sun is not a point source. The effects of the finite size of the Sun are incorporated into $A$, $B$, $C$, and $D$ in equations (4.2)--(4.4). These are trigonometric expressions known as the van de Hulst coefficients \citet{vdeh50}, and completely characterise the reception of light by the electron from across the entire solar disk, using only the angle $\Omega$, the angle subtended by the solar disk from point Q shown in Figure~\ref{fig:omega} \citep{minnaert1930, billings1966, billings1966} 
\begin{eqnarray}
A &=& \cos \Omega \sin^2 \Omega \\
%
B &=& -\frac{1}{8}\bigg[1 - 3\sin^2\Omega -\frac{\cos^2\Omega}{\sin\Omega}(1+3\sin^2\Omega)\textrm{ln}\bigg(\frac{1+\sin\Omega}{\cos\Omega}\bigg)\bigg] \\
%
C &=& \frac{4}{3} - \cos\Omega - \frac{\cos^3\Omega}{3} \\
%
D &=& \frac{1}{8}\bigg[5 + \sin^2\Omega -\frac{\cos^2\Omega}{\sin\Omega}(5-\sin^2\Omega)\textrm{ln}\bigg(\frac{1+\sin\Omega}{\cos\Omega}\bigg)\bigg] 
\end{eqnarray}
These coefficients and equations (4.2)--(4.4) form a complete description of the light scattered by an electron at any position in the solar atmosphere (any $\Omega$), with the observer at viewing angle $\chi$. The intensities given by these equations are for a single electron. If there is a number of electrons $N_e$, then the intensity would simply be $IN_e$; the intensity of scattered light from a point Q depends linearly on the total number of scattering electrons at that point. Hence if we know the intensity of scattered light we may directly infer the total number electrons contributing to this intensity. This allows a calculation of the total electron content of a CME, resulting in a mass calculation. However, the mass calculation os very sensitive to $\chi$, the viewing angle, and some important aspects of CME observation arise from this.

%As mentioned the above equations have a sensitive dependence of intensity and polarization on scattering angle $\chi$. The total intensity of scattered light is
%\begin{equation}
%I_{tot} =  2I_T - I_p \propto I_0\frac{\pi \sigma_e}{z^2}\bigg(1 - \frac{\mathrm{sin}^2\chi}{2}\bigg)
%\end{equation}
%So at $\chi=90$, $I_p$ is maximum, $I_R$ is minimum, $I_{tot}$ is minimum, and scattering efficiency is minimum. The dependency of each intensity component is shown in Figure~\ref{fig:Ivchi}. The tangential component $I_T$ remains constant at all viewing angles, whereas $I_R$ is maximum at $0^{\circ}$ or $180^{\circ}$ and minimum at $90^{\circ}$. Polarization is maximum at $90^{\circ}$. 
%\begin{figure}[!t]
%\begin{center}
%\includegraphics[scale=0.3]{IT_IR}
%\caption[Thomson scattered intensity as a function of viewing angle]{Thomson scattered intensity as a function of viewing angle.}
%\label{fig:Ivchi}
%\end{center}
%\end{figure}

Along any line of sight through the corona, the point at which $\chi = 90^{\circ}$ will be the point of minimum distance from the Sun. Three effects must be considered at this point; (i) scattering efficiency is a minimum, (ii) the incident intensity ($I_0$) received from the Sun is a maximum, and (iii) the electron density is a maximum. The latter two effects, (ii)--(iii), are a bigger contributor to the scattered light than the former (i). As a result scattered light is maximized at the point of $\chi = 90^{\circ}$ along the line of sight, despite the efficiency of scattering being a minimum at this point. Close to the Sun, the plane making an angle of $\chi = 90^{\circ}$ with the line of sight is known as the plane-of-sky (POS), and is the plane of maximum scattered intensity. Any CME erupting close to the POS will be well observed. However, eruption of a CME at a large angle away from the POS will result in less scattered light from the CME electrons, making the CME appear quite faint. If the angle from the POS is unknown, there is no way of telling the amount by which the intensity is reduced. 
%Observing a smaller intensity will result in the observer calculating a smaller number of electrons contributing to the scattered light. If no correction is made for the diminished intensity, the number of electrons and hence the total CME mass will be underestimated. The correction can only be made when the angle from the POS is known. As if often the case, the angle is unknown and we must assume the CME lies on the plane of sky. If this assumption is false, there will a proportion of the CME that we will go unaccounted for, 
This can lead to an underestimation of its mass content by up to a factor of 2 \citep{vou00}. As described in the next section, unknown viewing angles are the largest contributor to CME mass uncertainty.

\subsection{Mass Measurements and Uncertainties}
\begin{figure}[t!]
\begin{center}
\includegraphics[trim = 0cm 0cm 0cm 0cm, scale=0.4, angle=270]{images/LOS_POS_2.pdf}
\caption[Line-of-sight and plane-of-sky orientations]{Schematic showing the relative orientation of the line-of-sight (LOS), and the plane-of-sky (POS). Electron position is at point P and C is 
Sun center. The vector CP may also represent CME propagation direction. Scattering efficiency is heavily dependent on the angle $\theta$ 
(or $\chi$) and is least efficient 
when $\theta = 0^{\circ}$ ($\chi=90^{\circ})$.}
\label{fig:LOS_POS_2}
\end{center}
\end{figure}
Calculating the total mass of a CME first requires an estimation of the total amount of electrons contributing to the light scattered by the CME. This is usually done separately for each pixel. The amount of electrons contributing to a pixel brightness in a CME image is obtained from
\begin{equation}
n_{e}=\frac{I_{obs}}{I_{e}(\theta)}%\times1.97\times10^{-24}\,\mathrm{g}
\end{equation}
where $I_{obs}$ is the observed pixel brightness and $I_e$ is a single electron brightness at the position that the pixel images. 
The brightness $I_e(\theta)$ may be derived from equations (4.2)--(4.8). However, a number of assumptions must be made about where the electrons are located along the line of sight. Since no information on the angle with respect to the POS is available, we must assume that all electrons lie on the POS. However, if the electrons are actually propagating at $\theta>0$, we observe a diminished brightness from each electron. This diminished brightness is assumed to be the maximum possible electron brightness $I(\theta=0)$. Since we do not account for the fact that each electron is emitting less light than $I_e(\theta=0)$, we overestimate the contribution from each electron, leading to an underestimate of the number of scattering electrons. To quantify this, we plot a single electron brightness at $\theta>0$ divided by the POS electron brightness, $I(\theta=0)$, as a function of $\theta$, shown in Figure~\ref{fig:pos_angle}. For example, an electron located at $\theta=40^{\circ}$ will be $\sim$0.8 times as bright as an electron on the POS. Since the CME is simply a collection of electrons at $\theta=40^{\circ}$ and we are assuming that the CME is at $\theta=0$, we will underestimate its total electron content by 20\%. In this case we are assuming all of the CME electron content lies on the POS i.e., the CME is a 2D object. Since most observed limb CMEs occur within $\sim$$50^{\circ}$ of the POS, we expect that the POS assumption will underestimation total CME mass by up to a factor of 2 \citep{vou00}.


%This essentially means we are assuming the CME is a 2D object on the POS. However, if the CME is actually propagating at $theta>0$, we observe a diminished brightness.

%The method by which mass measurements are derived from white light coronagraph images is based on theory first developed by \citet{min30} in which the scattering geometry of a single electron at a particular point in the solar atmosphere is considered. Further development of the theory by \citet{vdeh50} led to the derivation of what are now known as the van de Hulst coefficients. The coefficients treat each component of the incident electric field vector separately and take into account the finite size of the solar disk \citep{min30, bil66, how09}. An important fact arising from these expressions is the dependence of scattering intensity on the angle, $\chi$, between the radial 
%vector from sun centre to the scattering electron and a position vector from observer towards the electron--the LOS, see
%Figure~\ref{fig:LOS_POS_2}. Scattering efficiency is minimized when this angle is $90^{\circ}$. However, along the LOS such an angle occurs at the point of minimum distance from sun centre where the incident intensity (that the electron receives) and electron density are maximized. This means scattered light in the corona is most intense along a plane 
%perpendicular to the observer's LOS despite the efficiency of scattering being minimized at such viewing angles \citep{how09}. This plane perpendicular to the LOS is known as the plane-of-sky (POS)


\begin{figure}[!t]
\begin{center}
\includegraphics[scale=0.4, trim=2cm 0cm 0cm 0cm]{pos_angle.pdf}
\caption[Electron brightness as function of angle]{Normalized 2D CME brightness as a function of elongation.}
\label{fig:pos_angle}
\end{center}
\end{figure}

%Studies using single LOS coronagraph data are often hindered by the unknown CME propagation angle from the POS, e.g., unknown $\theta$ (or $\chi$) in Figure~\ref{fig:LOS_POS_2}. This leads to the incorrect angle being used when inverting the van de Hulst coefficients to calculate the number of electrons contributing to the scattered light. The assumption that is made is that the CME propagates along the POS, and that all the CME material is constrained to this 2D plane. If the CME is propagating at some angle $\theta >0$ from the POS, but we assume that $theta=0$ we will underestimate its mass. Figure~\ref{fig:pos_angle} shows the brightness of a 2D CME propagating at some angle $\theta$, divided by the brightness of a 2D CME on the POS. The larger the angle of propagation, the less of smaller the intensity we observe. If we assume the CME to be on the POS, we attribute a diminished intensity to the maximum possible intensity of the CME.


%the POS  The proportion of the CME mass content we actually observe as a function of propagation angle is given in Figure~\ref{fig:pos_angle}. For example, if the CME has a POS angle of 40 degrees we will see its brightness


The second biggest contributor to mass underestimation is from assuming the CME is a 2D object when in fact it has a 3D extent.

!!!!!!!!!!!!!!!!

because the 3-D extent of the CME is unknown it is also assumed that the CME is confined to the 2-D sky plane, leading to a significant CME mass underestimation \citep{vou00}.
\begin{figure}[!t]
\begin{center}
\includegraphics[scale=0.4, trim=1cm 1cm 0cm 1cm]{angular_width.pdf}
\caption[Uncertainty due to CME angular width]{Uncertainty due to CME angular width}
\label{fig:ang_width_error}
\end{center}
\end{figure}





The CME of 2008 December 12 was Earth-directed \citep{byr10}, making it roughly the same angular distance from both the \emph{STEREO}\,A\,and\,B spacecraft, then located $\pm$45 degrees from Earth. This known angle of propagation was used to convert from pixel values of MSB to grams via the expression
\begin{equation}
m_{pixel}=\frac{B_{obs}}{B_{e}}\times1.97\times10^{-24}\,\mathrm{g}
\end{equation}
where $B_{obs}$ is the observed MSB of the pixel, $B_{e}$ is the electron brightness calculated from the van de Hulst coefficients, and 1.97$ \times10^{-24}$\,g is a factor that converts the number of electrons to mass, assuming a completely ionized corona with a composition of 90\% hydrogen and 10\% helium. The known angle of propagation allowed the correct value of $B_{e}$ to be computed resulting in a significant reduction in the uncertainties associated with the propagation angle. The largest remaining uncertainty is the unknown angular width along the LOS. This uncertainty was quantified in a similar approach to the method outlined in \citet{vou00}. This simulates the brightness of a CME with 
homogeneous density distribution and finite angular width along the LOS--longitudinal angular width $\Delta$$\theta_{long}$, allowing calculation of a simulated observed mass. Comparing this to the actual mass allowed for an evaluation of CME mass underestimation for given values of $\Delta$$\theta_{long}$.  Since the values for $\Delta$$\theta_{long}$ are unknown, the expression derived in \citet{byr10} for the \emph{latitudinal} 
angular width of this CME as a function of height, $\Delta$$\theta_{lat}$$(r)=25r^{0.22}$, was used to define an upper limit to $\Delta$$\theta_{long}$. It was assumed the CME longitudinal angular width is no more than twice the latitudinal angular width, or $\Delta$$\theta_{long}$$\leqslant$\,2$\times$$\Delta$$\theta_{lat}$. Such an upper limit is in agreement with simulations of flux-rope CMEs which give a typical aspect ratio of broadside to axial angular extents of 1.6\,--\,1.9 \citep{krall2006}. Hence the value for $\Delta$$\theta_{long}$ at each height was used to obtain the simulated mass underestimation estimates described above. The heights and angular widths used in this study produced CME mass underestimation estimates of between 5--10\% for finite angular width uncertainty. An extra mass uncertainty of 6\% was added to account for the assumption of coronal abundance of 90\% hydrogen and 10\% helium which can lead to slight errors while converting from pixel values of MSB to grams \citep{vour2010}. 

To calculate the CME mass a user-selected area (the extent of the CME, for example) of the base difference image was chosen and the pixel values within this area were summed to obtain total mass. Figure~\ref{fig:STEREO_COR2A&B} COR2 B images show an example of the sector over which pixels were summed (the smaller sectors indicate a different summing region used at a later stage). The selected area was chosen for each image in the time sequence of CME propagation so as to determine the mass variation with height in COR1 and 2 using both A and B. The selection of an area by a point and click method is of course a subjective identification of the the extent of the CME, 
so it is susceptible to user-generated uncertainties. To quantify these uncertainties the mass was obtained for each coronagraph image in the time sequence (as described above) and the process was repeated five times in order to obtain the mean CME mass for each image and the standard error on the mean. This standard error was defined as the uncertainty due to user bias in the point and click method of CME identification. The height at each measurement interval was taken to be the heliocentric distance of the CME apex in the image i.e., the apex of the front was chosen 
by simple point-and-click method. The uncertainty on the apex height was also found by the standard error on five runs.


The deflection of a small streamer during CME propagation produces negative pixels in the base difference images. The effect is particularly apparent in the COR1 images, Figure~\ref{fig:STEREO_COR1A&B}. It is difficult to unambiguously distinguish between streamer and CME, making it difficult to quantify the uncertainty introduced due to streamer interaction. To make an estimate of the streamer's effects, a calculation of its mass in the pre-event image was made. A number of different samples of the area of the streamer in the COR1\,B pre-event image that effects all subsequent images produced a mass estimate of $\sim$5$\times$10$^{14}$\,g. This mass was used as a measure of the uncertainty introduced due to streamer interaction in the COR1\,B images. A similar analysis of the COR1\,A pre-event images gave a streamer mass estimate of $\sim$7$\times$10$^{14}$\,g. COR2 images are relatively unaffected by significant changes in background coronal brightness and do not suffer from negative pixel values to as large an extent as COR1. The pre-event image of COR2\,B is particularly clean and free of background streamers, hence COR2\,B images are considered to provide most accurate CME mass estimation.

Finally, in order to obtain a more complete and continuous estimate of CME mass growth, the masses determined from both COR1 and COR2 coronagraphs were summed in those cases where image times of the inner and outer coronagraphs overlapped\footnote{A difference in cadence of the inner and outer coronagraphs means that the images closest in time have a three minute offset e.g., a COR1 image taken at 07:25 UT was considered to be coincident in time with the COR2 image at 07:22 UT}. The overlap in the inner and outer corongraphs' fields of view was also taken into account in this summation.


A concise measurement of the CME kinematics, such as velocity and acceleration, were taken from the results of the study of \citet{byr10}. Since these kinematics take into account the true three dimensional surface of the front they provide reliable estimates of CME velocity and acceleration in 3-D space. These velocity and acceleration measurements were used in the calculation of kinetic energy and total force on the CME for each point in time. The CME mass used in all energy and force calculations was the asymptotic mass it approaches at later stages of its evolution beyond 10\,$R_{\odot}$ as observed from the \emph{STEREO B} spacecraft i.e.,\,3.4\,$\pm$\,1.0$\times$10$^{15}$\,g. As will be shown, there is 
good motivation for the use of constant mass in the magnitude of kinetic energy and force estimates. 


\section{Results}\label{sec:11}
\subsection{Masses}

The results of the calculation for CME mass development with time and height for both \emph{STEREO} A and B coronagraphs are shown in Figure~\ref{fig:20081212_mass_ht}. In panel (a), the height values are those taken from a point-and-click method of tracking the CME apex; these heights are corrected for CME propagation angle of $\sim$$45^{\circ}$.  In both panels (a) and (b), the mass estimates of \emph{STEREO} A and B follow a similar trend and have similar values at each stage in the propagation. Such good agreement between mass values is a good indicator that $\sim$$45^{\circ}$ is the correct angle of propagation from the sky-plane. A change in the cadence of mass measurements is noticeable at $\sim$08:00 UT (or $\gtrsim$5\,$R_{\odot}$). This is due to the use of only COR1 images (with a cadence of 10\,minutes) prior to this time, and the use of the COR2 plus COR1 images after this time (the cadence of these measurements follows that of COR2\,--\,30\,minutes). Comparing A and B below 4.5\,$R_{\odot}$, mass values show a similar trend and increase at the same rate, but at approximately 3\,$R_{\odot}$ the mass measurements in COR1\,B appear to increase to a much larger value then fall again. This effect is visible in the COR1\,A measurements, albeit 
diminished. It is probably due to the presence of a prominence which contains a significant mass content and therefore contributes a large amount to total measured CME mass. Also, early on in its propagation, the prominence may still be emitting H-$\alpha$ line radiation (656.28 nm) due to the larger fraction of neutral hydrogen at its cooler temperatures.
\begin{figure}
\begin{center}
\includegraphics[scale=0.7, angle=0]{20081212_mass_ht.pdf}
\caption[CME mass as a function of height and time]{CME mass development with height (a) and time (b), for the 2008 December 12 CME. After $\sim$08:00 UT ($\gtrsim$5\,$R_{\odot}$) the 
masses from the inner and outer coronagraphs are summed to show uninterrupted 
mass development from $\sim$2--20\,$R_{\odot}$ over a period of 12 hours. The small bump in the 
CME mass at $\sim$07:00\,UT ($\sim$4\,$R_{\odot}$) is probably due to an unknown amount of H-$\alpha$ emission from the prominence. Mass of 
CME front and core are also shown, red $\textquoteleft$$\times$' and blue square, for COR2\,B, panel (b). After 14:52\,UT they share approximately 
equal mass. The inset of (a) shows mass development with height for COR2\,B only; the red curve represents a fit to the data whereby the mass 
asymptotically approaches $3.4\,\pm\,1.0\times10^{15}$\,g. }
\end{center}
\label{fig:20081212_mass_ht}
\end{figure}
\clearpage
The COR1 imaging passband is centered on H-$\alpha$ so any emission in the prominence from neutral hydrogen could be contributing to light received by the COR1 coronagraphs, this is apparent from the saturation region in the COR1\,B images in Figure~\ref{fig:STEREO_COR1A&B}. Since this is resonance line emission, and not Thomson scattered emission, it leads to an erroneous measurement in CME mass. Thus, it is assumed the larger rise and fall in 
CME mass is caused by the prominence entering and exiting the COR1\,B field of view. The effect is diminished in COR1\,A since the prominence does not enter the FOV to as large an extent as in COR1\,B. The interpretation that the $\textquoteleft$mass bump' is not actual mass growth (or loss) is supported by previous measurements where CME mass increase follows a trend with height described by $M_{cme}(h)=M_{a}(1-e^{-h/h_a})$, where $M_a$ is the final mass the CME approaches asymptotically and $h_a$ is the height at which the CME reaches 0.63$M_a$ \citep
{cola09}, with no  $\textquoteleft$bump'~in mass earlier on. The decline in mass after the peak may be explained by the ionization of neutral hydrogen such that H-$\alpha$ emission diminishes and simply becomes Thomson scattering of free electrons, as with the rest of the CME material. 

In order to produce a fit to the data, the COR2\,B mass results were chosen because its pre-event image was largely free of any bright streamers or other features which introduce unwanted effects in the production of base difference images, as described above. A fit with the above equation resulted in a final asymptotic CME mass of 3.4\,$\pm$\,1.0$\times$10$^{15}$\,g, with a scale height of $h_a=2.9\,R_{\odot}$. This fit is plotted along with the COR2\,B data in the inset panel of Figure~\ref{fig:20081212_mass_ht}(a). Note that the mass increase is due to material coming up from below the occulting disk, and not actual mass gain of the CME. The uncertainty on the above asymptotic mass value was taken to be 30\%, from the largest uncertainty  due to finite width, the conversion factor uncertainty as described above, the standard error user-generated uncertainty, and uncertainty due to streamer interaction.

In each image where the CME core and front are distinguishable, their masses were measured separately. This was regions demarcating the areas of core and front, see COR2\,B at 12:22\,UT and 14:52\,UT in Figure~\ref{fig:STEREO_COR2A&B} for an example of the separate core and front sectors over which pixel values were summed to obtain total mass. The uncertainties due to finite width of the observed object also apply to the core and front measurements, however, since the widths of these particular areas of the CME are unknown we chose the maximum uncertainty of 10\% from the above analysis since neither core nor front can be any wider than the maximum width assigned to this CME. The remaining uncertainties described above were also applied. The mass development of core and front with time is shown in Figure~\ref{fig:20081212_mass_ht}(b). The two mass measurements are subject to an observational effect of apparent exponential mass growth, however by the time the CME is fully in the field of view 
at 14:45\,UT the core and front share approximately equal mass. 


\subsection{Energies}\label{sec:2}

In the following calculations, all measurements of force and kinetic energy use the asymptotic mass of 3.4\,$\pm$\,1.0$\times$10$^{15}$\,g and not the instantaneous mass values calculated from each coronagraph image i.e., the CME is considered to begin its propagation with this mass and does not acquire any mass as it propagates. 

Estimates of the force and kinetic energy use the 3-D velocity and acceleration measurements produced by \citet{byr10}. Their method firstly identifies the CME front in each coronagraph image using a multiscale edge detection filter. The front edges were then used to define a quadrilateral in space into which an ellipse is fit, this method is known as elliptical tie-pointing. This was done for multiple horizontal planes through the CME so that the fit ellipses outline a curved front in 3-D space.The speed and acceleration were then deduced from the change in position of the front, with time, through the \emph{STEREO} COR1, COR2 and HI fields of view. Since mass measurements in this study use only the COR1 and COR2 coronagraphs, HI kinematics measurements have been excluded here. The CME front position uncertainty in \emph{STEREO A}\,and\,\emph{B} coronagraphs was determined from the filter width in the multiscale analysis. Velocity and acceleration uncertainties were then propagated from position uncertainty.  Figure~\ref{fig:force_20081212}(a) shows CME velocity as a function of heliocentric distance, along with acceleration in panel (b). 

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.75, angle=0]{images/20081212_force_v2.pdf}
\caption[CME kinematics and energetics as a function of height]{(a) CME velocity as a function of heliocentric distance, including a fit to the data produced using an aerodynamic drag model beyond $\sim$7\,$R_{\odot}$ \citep{byr10}. (b) Acceleration of CME, including fit,  derived from the velocity data and fit. 
Panel (c) and (d) show the kinetic energy and force, respectively, both calculated using constant CME mass of $3.4\,\pm\,1.0\times10^{15}$\,g and kinematics results from (a) and (b). Also shown are the fits to energy and force produced from fits to velocity and acceleration.}
\end{center}
\label{fig:force_20081212}
\end{figure}
\clearpage

The CME kinetic energy was calculated using $E_{kin}=1/2M_{cme}v_{cme}^{2}$, where $M_{cme}$ is the final asymptotic mass of 3.4\,$\pm$\,1.0$\times$10$^{15}$\,g and $v_{cme}$ are the instantaneous velocity measurements, results of this calculation are shown in Figure~\ref{fig:force_20081212}(c). The kinetic energy shows 
an initial rise towards 6.3\,$\pm$\,3.7$\times$10$^{29}$\,ergs at $\sim$3\,$R_{\odot}$, beyond which it rises steadily to 4.2\,$\pm$\,2.5$\times$10$^{30}$\,ergs at $\sim$18\,$R_{\odot}$, these values are similar to those reported in \citet{vou00,vour2010} and \citet{emslie2004}. 

The total force on the CME was calculated using $F_{total}=M_{cme}a_{cme}$, where $M_{cme}$ is as above and $a_{cme}$ is taken from the instantaneous acceleration values. As shown in panel (d) of Figure~\ref{fig:force_20081212}, the force initially grows significantly, reaching a maximum value of 3.4\,$\pm$\,2.2$\times$10$^{14}$\,N at $\sim$3\,$R_
{\odot}$. The early rise and fall in acceleration (or force) is in agreement with a previous study of a CME observed to reach peak acceleration at $\sim$1.7\,$R_{\odot}$ after which it reaches a constant velocity beyond $\sim$3.4\,$R_{\odot}$ \citep{gallagher03}.  Such results are also found in a statistical study which shows that the majority of CMEs have peak acceleration in the low corona with a mean height of maximum acceleration at 1.5\,$R_{\odot}$ 
\citep{bein2011}. Similarly, observational studies by \citet{zhang2001} and \citet{zhang2004} also show early phase peak acceleration between 2--5\,$R_{\odot}$ and forces on the order of 10$^{15}$\,N and 10$^{12}$\,N, depending on whether the CME shows large initial acceleration or a slow, more gradual acceleration.

After this early peak, the force drops to an average value of 3.8$\pm$5.4$\times$10$^{13}$\,N at distances between 7--18\,$R_{\odot}$. It is apparent from Figure~\ref{fig:force_20081212}(a) that the velocity continues to increase beyond $7\,R_{\odot}$, implying that a positive radial force must be present. To clarify this, a fit to the velocity data using a model for solar wind drag on the CME beyond $7\,R_{\odot}$ (as outlined in \citet{byr10}) is shown in Figure~\ref{fig:force_20081212}(a). Although the data suggest a non-monotonic increase in velocity, the fit reveals that propagation is best described by a steadily increasing velocity between 7--18\,$R_{\odot}$. The acceleration and kinetic energy curves derived from this velocity fit are shown in Figure~\ref{fig:force_20081212}(b) and (c). In Figure~\ref{fig:force_20081212}(d), the curve for the force derived from the velocity fit initially deviates from the data at $\sim$7\,$R_{\odot}$, however beyond this distance there is good agreement with the data and the derived force is entirely positive.  This suggests that the solar wind exerts a positive aerodynamic drag force on the CME, resulting in a velocity that approaches the asymptotic solar wind speed at large heliospheric distances. 

%\subsection{Mechanical Energy}\label{sec:20}

\subsection{Forces}\label{sec:21}

It should be noted that Figure~\ref{fig:20081212_mass_ht} shows an overall exponential increase in CME mass with height which could be interpreted as the CME rapidly gaining mass as it propagates. Care should be taken with this interpretation since this apparent exponential mass increase is almost certainly due to the CME moving into the field of view, therefore allowing us to measure more of its mass content; such an interpretation is in agreement with similar assertions made in \citet{vour2010}. It is difficult to distinguish between actual CME mass growth and an apparent growth due to more of the CME being observed. If the initial early rise in CME mass is assumed to be an observational artifact then we can interpret the CME mass to be in the range of (3--3.5)$\times$10$^{15}$\,g for most of its early propagation i.e., the CME already has such a mass before launch and does not acquire more mass (via inflows or otherwise) during propagation.
Such an interpretation is in agreement with CME mass measurements calculated from dimmings in \emph{STEREO} Extreme Ultraviolet Image(EUVI) images, which show the mass calculated from EUV images to be approximately equal to CME mass in COR2 images,  $m_{EUVI}/m_{COR2} =1.1\pm0.3$  \citep{aschw09}. Once the CME bubble is in the field of view at $\sim$10\,$R_{\odot}$ the mass in its entirety can be measured and the increase beyond this point, if any, is slow and steady, Figure~\ref{fig:20081212_mass_ht}.

The early stages of CME propagation are dominated by a sharp rise to a peak force of 3.4\,$\pm$\,2.2$\times$10$^{14}$\,N at $\sim$3\,$R_{\odot}$ followed by a sharp decline, Figure~\ref{fig:force_20081212}(d). The catastrophe model \citep{forbes1991,forbes1995,lin2000}, magnetic breakout model \citep{antio99,lynch2008}, and toroidal instability model \citep{chen1996,kleim2006} employ a number of forces acting on the CME to produce an over all acceleration into interplanetary space. For example, the toroidal instability model used by \citet{chen1996} uses a Lorentz hoop force (or Lorentz self-force), solar wind drag, and gravity to provide a net force acting on the CME between 2--3\,$R_{\odot}$ that quickly 
rises to a peak total force of $\sim$10$^{16}$\,N and then falls rapidly.

If we assume that the peak force observed for the 2008 December 12 CME is the net force due to similar forces used in the above models, such as the solar wind drag, gravity, and some form of magnetic CME driver e.g., a $\vec{J}\,\times\,\vec{B}$ force, we may estimate their relative contribution. The force due to solar wind drag on the CME is given by
\begin{equation}
\vec{F}_d=-\frac{1}{2}C_{d}\rho_{sw}A_{cme}(\vec{v}-\vec{v}_{sw})\mid\,\vec{v}-\vec{v}_{sw}\mid
\end{equation}
where $M_{cme}$ is the CME mass, $\vec{v}$ is the CME velocity, $C_{d}$ is the drag coefficient, $\rho_{sw}$ is the solar wind mass density, $A_{cme}$ is the CME area exposed to solar wind drag and $\vec{v}_{sw}$ is the solar wind velocity \citep{malo10}. To estimate the effects of this force we use $\rho_{sw}=n_{p}m_{p}$, where $m_{p}$ is proton mass, and assume ionization fraction of $\chi$\,=\,1 such that $n_{p}=n_{e}$\,$[cm^{-3}]$. Electron density, and hence proton density, is then given by an interplanetary density model derived from a special solution of the Parker solar wind equation \citep{Mann1999}, solar wind velocity values as a function of height are also determined using this model. $A_{cme}$ is estimated using the expression derived in \citet{byr10} for latitudinal angular width of the CME as a function of height, $\Delta$$\theta_{lat}$$(r)=26r^{0.22}$. This is used to derive an arc length of the CME front and, as above, making the assumption $\Delta$$\theta_{long}$$=$\,2$\times$$\Delta$$\theta_{lat}$, the two arc lengths derived from these angles then give the surface that the solar wind acts on, thus $A_{cme}$\,=\,1352$r^{2.44}$. Setting the drag coefficient $C_{d}=1$, and using the \citet{Mann1999} model to derive a density and a solar wind velocity of 2.3$\times$10$^{5}$\,cm$^{-3}$  and 70\,km\,s$^{-1}$, respectively, equation [1] then gives a force of $\vec{F}_{d}=-8.0\times10^{12}\,\hat{r}\,$\,N for solar wind drag at $\sim$3\,$R_{\odot}$, where $\hat{r}$ is a unit vector in the positive radial direction. 

A simple estimate of force due to gravity is given by $\vec{F}_{g}=GM_{\odot}M_{cme}/\vec{r}\,^2$, where $G$ is the universal gravitational constant, $M_{\odot}$ is solar mass, $M_{cme}$ is CME mass, and $\vec{r}$ is a heliocentric position vector\footnote{Ideally the heliocentric distance of the CME centre of mass would be used here. However an unknown amount of mass is obscured by the coronagraphs occulting disk, making the mass distribution and hence COM difficult to determine. Thus the CME front height is used in the calculation of force due to gravity}. Given a CME mass of 3.4$\times$10$^{15}$\,g the force due to gravity at a heliocentric distance of 3\,$R_{\odot}$ is $\vec{F}_{g}=-1.0\times10^
{14}\,\hat{r}$\,N. The only remaining contribution is due to some form of magnetic CME driver, $F_{mag}$, which is estimated using 
\begin{equation}
\vec{F}_{mag}= \vec{F}_{total}-\vec{F}_{d}-\vec{F}_{g}
\end{equation}
(the pressure gradient in the CME equation of motion is assumed to be negligable and has been omitted here). Using the above values, the total magnetic contribution to CME force is calculated to be $\vec{F}_{mag}\approx4.5\times10^{14}\,\hat{r}$\,N at 3\,$R_{\odot}$, indicating that this is the largest driver of CMEs at low coronal heights. Lorentz force dominated dynamics in early phase CME propagation are reported in \citet{bein2011}, in which a statistical study of a large sample of CMEs in EUVI, COR1, and COR2 indicated an early phase acceleration for the majority of CMEs that is attributable to a Lorentz force.  A similar result of an observational study by \citet{vrs06} found that the Lorentz force plays a dominant role within a few solar radii. It should be noted that although we have labelled the force $F_{mag}$, there is no distinction on the exact form of this force e.g., whether it is magnetic pressure, magnetic tension, or a Lorentz self-force that acts as the driver. Also, any non-radial motion of the CME, such as that described in \citet{byr10}, is not taken into account here; any force estimates are purely radial in direction.


 \section{Conclusion} \label{bozomath}
 The \emph{STEREO} COR1/2 coronagraphs have been used to determine the mass development of the 2008 December 12 CME. Knowledge of the longitudinal propagation angle of the CME allowed for a significant reduction in the mass uncertainty, giving a final estimate of 3.4\,$\pm$\,1.0$\times$10$^{15}$\,g. Using kinematics results of a previous study \citep{byr10}, the velocity and acceleration of the CME were combined with the mass measurements to determine the kinetic energy and total force on the CME. The early phase propagation of the CME was found to be dominated by a force of peak magnitude of 3.4\,$\pm$\,2.2$\times$10$^{14}$\,N at $\sim$3.0\,$R_{\odot}$, after which the magnitude declines 
rapidly and settles to and average of 3.8 $\pm$ 5.4$\times$10$^{13}$\,N. This early rise and fall in total force (or acceleration) is in agreement with previous observations of CME kinematics \citep{gallagher03, bein2011}. Similarly results of observational studies by \citet{zhang2001} and \citet{zhang2004} also show early phase peak acceleration between 2--5\,$R_{\odot}$ and forces on the order of 10$^{15}$\,N and 10$^{12}$\,N. The kinetic energy shows an initial rise steadily to 4.2\,$\pm$\,2.5$\times$10$^{30}$\,ergs at $\sim$18\,$R_{\odot}$, such order of magnitudes are similar to those reported in \citet{vou00,emslie2004} and are typical of CME kinetic energies \citep{vour2010}.

Such CME kinematics and dynamics property estimates cannot be carried out when unknown propagation angle hinders an accurate calculation of CME mass, hence adding unacceptable uncertainty to any subsequent calculations. This highlights the need for similar studies using the \emph{STEREO} mission's ability to accurately determine the physical properties of CMEs, such as mass, with remarkably reduced uncertainty. Increasing the accuracy of force estimates of other well studied CMEs will allow for a more complete view of the magnitude of the forces influencing CME propagation and will allow model parameters to be more accurately constrained.




